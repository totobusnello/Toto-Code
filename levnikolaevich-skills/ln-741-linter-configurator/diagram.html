<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ln-741-linter-configurator - Workflow Diagram</title>
    <link rel="stylesheet" href="../shared/css/diagram.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad: true, theme: 'default'});</script>
</head>
<body>
    <h1>ln-741-linter-configurator</h1>
    <p>L3 Worker - Configures linting and formatting tools</p>

    <h2>Main Workflow</h2>
    <div class="mermaid">
stateDiagram-v2
    [*] --> CheckExisting: Start Linter Setup

    state CheckExisting {
        [*] --> GlobConfigs
        GlobConfigs --> EvaluateFound
        EvaluateFound --> DecideAction
        DecideAction --> [*]
    }

    CheckExisting --> Decision: Configs Evaluated

    state Decision {
        [*] --> NoneFound
        [*] --> PartialFound
        [*] --> CompleteFound

        NoneFound --> CreateNew: Create from template
        PartialFound --> AskUser: Merge or replace?
        CompleteFound --> Skip: Inform user
    }

    Decision --> Generate: Action Determined

    state Generate {
        [*] --> CopyTemplates
        CopyTemplates --> CustomizePlaceholders
        CustomizePlaceholders --> AddScripts
        AddScripts --> [*]
    }

    Generate --> Install: Configs Created
    Install --> Verify: Dependencies Installed
    Verify --> [*]: Linter Working
    </div>

    <h2>Stack Detection Flow</h2>
    <div class="mermaid">
flowchart TD
    Start([Input: Project Path]) --> Detect{Detect Stack}

    Detect -->|package.json + tsconfig| TS[TypeScript Stack]
    Detect -->|*.csproj or *.sln| NET[.NET Stack]
    Detect -->|pyproject.toml| PY[Python Stack]
    Detect -->|Multiple| MIXED[Configure All]

    subgraph TS[TypeScript Stack]
        ESLint[eslint.config.mjs]
        Prettier[.prettierrc]
        ESLintPrettier[eslint-config-prettier]
    end

    subgraph NET[.NET Stack]
        EditorConfig[.editorconfig]
        BuildProps[Directory.Build.props]
    end

    subgraph PY[Python Stack]
        Ruff[ruff.toml]
        RuffNote[Replaces Black + isort + flake8]
    end

    TS --> Output([Configured])
    NET --> Output
    PY --> Output
    MIXED --> Output

    classDef typescript fill:#3178C6,color:white
    classDef dotnet fill:#512BD4,color:white
    classDef python fill:#3776AB,color:white
    class ESLint,Prettier,ESLintPrettier typescript
    class EditorConfig,BuildProps dotnet
    class Ruff python
    class RuffNote fill:#FFF8DC
    </div>

    <h2>Dependency Installation</h2>
    <div class="mermaid">
flowchart LR
    subgraph TypeScript["TypeScript Dependencies"]
        direction TB
        npm[npm install -D]
        eslintPkg[eslint @eslint/js]
        tsPkg[typescript-eslint]
        reactPkg[eslint-plugin-react<br>eslint-plugin-react-hooks]
        prettierPkg[prettier<br>eslint-config-prettier]
    end

    subgraph DotNet[".NET Dependencies"]
        direction TB
        sdk[.NET SDK 8+]
        analyzers[Microsoft.CodeAnalysis<br>.NetAnalyzers]
        note1[Configured via<br>Directory.Build.props]
    end

    subgraph Python["Python Dependencies"]
        direction TB
        pip[pip install / uv add]
        ruffPkg[ruff]
        note2[Single tool<br>replaces 70+ packages]
    end

    classDef cmd fill:#333,color:white
    classDef pkg fill:#E6E6FA
    classDef note fill:#FFF8DC
    class npm,sdk,pip cmd
    class eslintPkg,tsPkg,reactPkg,prettierPkg,analyzers,ruffPkg pkg
    class note1,note2 note
    </div>

    <h2>Verification Flow</h2>
    <div class="mermaid">
flowchart TD
    Start([Verify Setup]) --> RunLint{Run Lint}

    RunLint -->|Exit 0| LintPass[Lint PASS]
    RunLint -->|Exit 1+| LintFail[Lint FAIL]

    LintPass --> RunFormat{Run Format Check}
    LintFail --> FixConfig[Check Config]
    FixConfig --> RunLint

    RunFormat -->|No changes| FormatPass[Format PASS]
    RunFormat -->|Changes needed| FormatFail[Format FAIL]

    FormatPass --> Complete([Setup Complete])
    FormatFail --> CheckPrettier[Check eslint-config-prettier]
    CheckPrettier --> RunFormat

    classDef pass fill:#90EE90
    classDef fail fill:#FFB6C1
    class LintPass,FormatPass pass
    class LintFail,FormatFail fail
    </div>

    <footer>
        <p>ln-741-linter-configurator v2.0.0 | Last Updated: 2026-01-10</p>
    </footer>
</body>
</html>
