<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ln-110-documents-pipeline - State Diagram</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="stylesheet" href="../shared/css/diagram.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ln-110-documents-pipeline</h1>
            <p class="subtitle">Documentation Pipeline Orchestrator - State Diagram</p>
        </header>

        <div class="info-box">
            <h3>Workflow Overview</h3>
            <ul>
                <li><strong>Purpose:</strong> Create complete documentation system (CLAUDE.md + docs/ + presentation/) in one command</li>
                <li><strong>Orchestrates:</strong> 5 workers (ln-111 → ln-112 → ln-113 → ln-114 → ln-115)</li>
                <li><strong>Phases:</strong> 4 phases (User Confirmation → Worker Invocation → Global Cleanup → Summary)</li>
                <li><strong>Error handling:</strong> Stops if any invoked worker fails</li>
            </ul>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color color-action"></div>
                <span>Orchestration Action</span>
            </div>
            <div class="legend-item">
                <div class="legend-color color-decision"></div>
                <span>Completion Check</span>
            </div>
            <div class="legend-item">
                <div class="legend-color color-error"></div>
                <span>Error State</span>
            </div>
        </div>

        <div class="diagram-container">
            <div class="mermaid">
graph TD
    Start([Start: ln-110-documents-pipeline]) --> Phase1[Phase 1: User Confirmation<br/>Explain workflow + get approval]

    Phase1 --> Approved{User<br/>approved?}
    Approved -->|No| Cancelled([Cancelled by user])
    Approved -->|Yes| TestDocs{Include test<br/>docs?}

    TestDocs --> W1[Phase 2.1: Invoke ln-111-project-docs-creator<br/>Root docs + Project docs]

    W1 --> W1Check{ln-111<br/>completed?}
    W1Check -->|No| Error[Error: Worker failed]
    W1Check -->|Yes| W2[Phase 2.2: Invoke ln-112-reference-docs-creator<br/>docs/reference/ structure]

    W2 --> W2Check{ln-112<br/>completed?}
    W2Check -->|No| Error
    W2Check -->|Yes| W3[Phase 2.3: Invoke ln-113-tasks-docs-creator<br/>docs/tasks/ + kanban_board.md]

    W3 --> W3Check{ln-113<br/>completed?}
    W3Check -->|No| Error
    W3Check -->|Yes| CheckTest{Test docs<br/>enabled?}

    CheckTest -->|Yes| W4[Phase 2.4: Invoke ln-114-test-docs-creator<br/>tests/README.md]
    CheckTest -->|No| W5

    W4 --> W4Check{ln-114<br/>completed?}
    W4Check -->|No| Error
    W4Check -->|Yes| W5[Phase 2.5: Invoke ln-115-presentation-creator<br/>docs/presentation/ HTML]

    W5 --> W5Check{ln-115<br/>completed?}
    W5Check -->|No| Error
    W5Check -->|Yes| Phase4[Phase 4: Global Cleanup<br/>Deduplication + Orphan removal<br/>Consolidation + Cross-links]

    Phase4 --> Phase4Check{Phase 4<br/>completed?}
    Phase4Check -->|No| Error
    Phase4Check -->|Yes| Summary[Phase 5: Summary<br/>Display completion report]

    Summary --> End([End: Documentation created])
    Error --> End
    Cancelled --> End

    %% Styling
    classDef action fill:#C8E6C9,stroke:#388E3C,stroke-width:2px
    classDef decision fill:#FFE0B2,stroke:#E64A19,stroke-width:2px
    classDef error fill:#FFCDD2,stroke:#C62828,stroke-width:2px

    class Phase1,W1,W2,W3,W4,W5,Phase4,Summary action
    class Approved,TestDocs,W1Check,W2Check,W3Check,W4Check,W5Check,Phase4Check,CheckTest decision
    class Error error
            </div>
        </div>

        <div class="info-box">
            <h3>Key Features</h3>
            <ul>
                <li><strong>One Command:</strong> Creates entire documentation system in single invocation</li>
                <li><strong>Sequential Execution:</strong> 5 workers invoked in order (15-20 minutes total)</li>
                <li><strong>Optional Test Docs:</strong> ln-114-test-docs-creator can be skipped</li>
                <li><strong>Global Cleanup:</strong> Phase 4 removes duplicates, orphaned files, validates cross-links</li>
                <li><strong>Error Handling:</strong> Stops execution if any worker fails, shows partial progress</li>
            </ul>
        </div>

        <footer>
            <p>Generated for ln-110-documents-pipeline skill | Version 6.0.0</p>
            <p>Diagram format: Mermaid.js | Last updated: 2025-12-18</p>
        </footer>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html>
