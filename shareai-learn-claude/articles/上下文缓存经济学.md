# å¤§æ¨¡å‹ä¸Šä¸‹æ–‡ç¼“å­˜ç»æµå­¦ï¼šåˆ«è®©ä½ çš„Agent"çƒ§é’±"

> **æ ¸å¿ƒè­¦å‘Š**: ä½ ä¹ ä»¥ä¸ºå¸¸çš„"ç¼–è¾‘æ¶ˆæ¯ã€ä¿®æ”¹å†å²ã€DIYä¸Šä¸‹æ–‡"æ“ä½œï¼Œåœ¨LLM Agentä¸­ä¼šè®©æˆæœ¬æš´å¢7-50å€ã€‚æœ¬æ–‡å¸®ä½ å»ºç«‹ç¼“å­˜æ„è¯†ï¼Œé¿å…æˆæœ¬ç¾éš¾ã€‚

---

## ğŸš¨ å¦‚æœä½ æ­£åœ¨åšè¿™äº›äº‹ï¼Œè¯·ç«‹å³åœæ­¢

```python
# âŒ å±é™©æ“ä½œ1: æ¯æ¬¡éƒ½ä¿®æ”¹system prompt
system = f"Current step: {step}, files: {files}..."  # æˆæœ¬çˆ†ç‚¸!

# âŒ å±é™©æ“ä½œ2: ç¼–è¾‘å†å²æ¶ˆæ¯
messages[2]["content"] = "updated content"  # ç¼“å­˜å…¨å¤±æ•ˆ!

# âŒ å±é™©æ“ä½œ3: åˆ é™¤æ—§æ¶ˆæ¯ï¼ˆæ»‘åŠ¨çª—å£ï¼‰
messages = messages[-10:]  # æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—!

# âŒ å±é™©æ“ä½œ4: ç”¨æ‘˜è¦æ›¿æ¢å†å²
messages = [summary] + messages[15:]  # å‰ç¼€å˜äº†ï¼Œç¼“å­˜å¤±æ•ˆ!

# âŒ å±é™©æ“ä½œ5: åœ¨ä¸­é—´æ’å…¥æ¶ˆæ¯
messages.insert(5, new_message)  # åé¢å…¨éƒ¨å¤±æ•ˆ!
```

**è¿™äº›æ“ä½œåœ¨ä¼ ç»Ÿç¼–ç¨‹ä¸­å¾ˆæ­£å¸¸ï¼Œä½†åœ¨LLM APIä¸­ä¼šè®©ä½ çš„æˆæœ¬å¢åŠ å‡ åå€ã€‚**

---

## 1. æ€ç»´è½¬å˜ï¼šä¸Šä¸‹æ–‡ä¸æ˜¯"å¯ç¼–è¾‘çš„å˜é‡"ï¼Œè€Œæ˜¯"åªè¿½åŠ çš„æ—¥å¿—"

### 1.1 ä¼ ç»Ÿç¼–ç¨‹æ€ç»´ vs LLM Agentå¼€å‘

**ä¼ ç»Ÿåç«¯å¼€å‘** (ä½ ä¹ æƒ¯çš„æ–¹å¼):
```python
# æ•°æ®æ˜¯å¯ä»¥éšæ„ä¿®æ”¹çš„
user_state = {"step": 1, "data": []}
user_state["step"] = 2  # ä¿®æ”¹çŠ¶æ€
user_state["data"].append(new_item)  # æ·»åŠ æ•°æ®
del user_state["history"]  # åˆ é™¤ä¸éœ€è¦çš„
```

**LLM Agentå¼€å‘** (å¿…é¡»éµå®ˆçš„è§„åˆ™):
```python
# ä¸Šä¸‹æ–‡æ˜¯"åªè¿½åŠ æ—¥å¿—"ï¼Œä¸€æ—¦ä¿®æ”¹å‰ç¼€ = ç¼“å­˜å…¨å¤±æ•ˆ
messages = [system_msg]  # æ°¸ä¸æ”¹å˜
messages.append(user_msg)  # âœ… åªèƒ½è¿½åŠ 
messages.append(assistant_msg)  # âœ… åªèƒ½è¿½åŠ 
# messages[0] = xxx  # âŒ ä¿®æ”¹å‰ç¼€ = æˆæœ¬çˆ†ç‚¸
# messages = messages[-10:]  # âŒ åˆ é™¤ = æˆæœ¬çˆ†ç‚¸
```

**å…³é”®è®¤çŸ¥**: LLM APIçš„ä¸Šä¸‹æ–‡æœ‰"å‰ç¼€ç¼“å­˜"æœºåˆ¶â€”â€”å‰ç¼€ä¸å˜å°±èƒ½å¤ç”¨ï¼Œå‰ç¼€ä¸€å˜å°±è¦å…¨éƒ¨é‡ç®—ã€‚

### 1.2 å¿½è§†ç¼“å­˜çš„çœŸå®ä»£ä»·

è®¸å¤šä¼ ç»Ÿ AI å¼€å‘è€…åœ¨ä½¿ç”¨ **LangGraphã€LangChainã€AutoGen** ç­‰æ¡†æ¶å¼€å‘ Agent æ—¶ï¼Œä¹ æƒ¯æ€§åœ°é‡‡ç”¨ä¼ ç»Ÿè½¯ä»¶å¼€å‘æ€ç»´ï¼š

- ç¼–æ’å’Œç¼–è¾‘ä¸Šä¸‹æ–‡
- DIY æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ’å…¥ã€åˆ é™¤ã€ä¿®æ”¹å†å²æ¶ˆæ¯
- å‹ç¼©æˆ–æ‘˜è¦æ›¿æ¢é•¿å¯¹è¯
- åœ¨ system prompt ä¸­æ³¨å…¥åŠ¨æ€çŠ¶æ€
- ä½¿ç”¨æ»‘åŠ¨çª—å£æˆªæ–­æ—§æ¶ˆæ¯

**è¿™äº›æ“ä½œåœ¨ä¼ ç»Ÿè½¯ä»¶ä¸­æ˜¯æ­£å¸¸çš„ï¼Œä½†åœ¨å¤§æ¨¡å‹ API ä¸­ä¼šå¯¼è‡´ç¼“å­˜å®Œå…¨å¤±æ•ˆï¼Œæˆæœ¬å’Œæ€§èƒ½åŒé‡çˆ†ç‚¸ã€‚**

### 1.2 æˆæœ¬å·®è·æœ‰å¤šå¤§ï¼Ÿ

ä¸€ä¸ªå…¸å‹çš„ SWE (è½¯ä»¶å·¥ç¨‹) Agent ä»»åŠ¡å¯èƒ½æ¶ˆè€— **100K-1M tokens**ã€‚å¦‚æœä½ çš„ Agent æ¯å¤©å¤„ç† 100 ä¸ªä»»åŠ¡ï¼ŒæŒ‰ Claude Sonnet 4.5 çš„ $3/M è¾“å…¥ä»·æ ¼è®¡ç®—ï¼š

| ç­–ç•¥ | æ¯å¤©æˆæœ¬ | å¹´æˆæœ¬ | è¯´æ˜ |
|------|---------|--------|------|
| **ç ´åç¼“å­˜** (æ¯è½®ç¼–è¾‘ä¸Šä¸‹æ–‡) | **$150** | **$54,750** | æ¯è½®é‡æ–°è®¡ç®—å…¨éƒ¨ä¸Šä¸‹æ–‡ |
| **æœ‰ç¼“å­˜ä¼˜åŒ–** (åªè¿½åŠ ) | **$26** | **$9,490** | 60% ç¼“å­˜å‘½ä¸­ç‡ |
| **èŠ‚çœ** | **$124/å¤©** | **$45,260/å¹´** | **83% æˆæœ¬èŠ‚çœ** |

å¯¹äºä¸€ä¸ªä¸­ç­‰è§„æ¨¡çš„ Agent åº”ç”¨ï¼Œ**ç†è§£ç¼“å­˜æœºåˆ¶å¯ä»¥æ¯å¹´èŠ‚çœæ•°ä¸‡åˆ°æ•°åä¸‡ç¾å…ƒ**ã€‚

### 1.3 è‡ªå›å½’æ¨¡å‹çš„æœ¬è´¨ç‰¹å¾

å¤§è¯­è¨€æ¨¡å‹æ˜¯**è‡ªå›å½’**çš„â€”â€”ç”Ÿæˆæ¯ä¸ªæ–° token éƒ½éœ€è¦ attend åˆ°ä¹‹å‰æ‰€æœ‰ tokenã€‚è¿™æ„å‘³ç€ï¼š

```
ä¸Šä¸‹æ–‡é•¿åº¦: 50K tokens
ç”Ÿæˆ 1 ä¸ª token: éœ€è¦å¯¹ 50K tokens åš attention
ç”Ÿæˆ 100 ä¸ª token: éœ€è¦å¯¹ 50K-50.1K tokens åš attentionï¼Œå…± 5,005,000 æ¬¡ attention æ“ä½œ
```

å¦‚æœä½ **æ¯æ¬¡è¯·æ±‚éƒ½ä¿®æ”¹ä¸Šä¸‹æ–‡çš„å‰ç¼€**ï¼š
- ä¹‹å‰ç¼“å­˜çš„ KV å‘é‡å…¨éƒ¨å¤±æ•ˆ
- å¤§æ¨¡å‹æä¾›å•†éœ€è¦é‡æ–°è®¡ç®—æ•´ä¸ªå‰ç¼€
- ä½ éœ€è¦ä¸ºç›¸åŒå†…å®¹é‡å¤ä»˜è´¹

å¦‚æœä½ **åªè¿½åŠ æ–°å†…å®¹**ï¼š
- æä¾›å•†å¤ç”¨å·²ç¼“å­˜çš„ KV å‘é‡
- åªè®¡ç®—æ–°å¢éƒ¨åˆ†
- ç¼“å­˜å‘½ä¸­éƒ¨åˆ†äº«å— **90% æŠ˜æ‰£** (å¤§éƒ¨åˆ†æä¾›å•†)

## 2. è‡ªå›å½’æ¨¡å‹ä¸ KV Cache åŸç†

### 2.1 ä¸ºä»€ä¹ˆéœ€è¦ç¼“å­˜ï¼Ÿ

å¤§è¯­è¨€æ¨¡å‹æ˜¯**è‡ªå›å½’**çš„ï¼šç”Ÿæˆæ¯ä¸ª token éƒ½éœ€è¦ attend åˆ°ä¹‹å‰æ‰€æœ‰ tokenã€‚

```
è¾“å…¥: [A, B, C, D, E]
ç”Ÿæˆ F: Attention(F, [A,B,C,D,E])  â†’ è®¡ç®— 5 æ¬¡ attention
ç”Ÿæˆ G: Attention(G, [A,B,C,D,E,F]) â†’ è®¡ç®— 6 æ¬¡ attention
```

å¯¹äº 200K ä¸Šä¸‹æ–‡çª—å£ï¼Œæ¯ç”Ÿæˆä¸€ä¸ª token éƒ½è¦ä¸å‰é¢æ‰€æœ‰ token åš attention è®¡ç®—ã€‚**KV Cache** é€šè¿‡ç¼“å­˜å·²è®¡ç®—çš„ Key-Value å‘é‡æ¥é¿å…é‡å¤è®¡ç®—ã€‚

### 2.2 Prompt Cache çš„å·¥ä½œåŸç†

```
è¯·æ±‚ 1: [System, User1, Asst1, User2]
        â†â”€â”€â”€â”€â”€â”€ å…¨éƒ¨è®¡ç®— â”€â”€â”€â”€â”€â”€â†’
        (é¦–æ¬¡å¤„ç†ï¼Œå†™å…¥ç¼“å­˜)

è¯·æ±‚ 2: [System, User1, Asst1, User2, Asst2, User3]
        â†â”€â”€â”€â”€â”€â”€ ç¼“å­˜å‘½ä¸­ â”€â”€â”€â”€â”€â”€â†’ â†â”€ æ–°è®¡ç®— â”€â†’
        (å¤ç”¨å·²ç¼“å­˜çš„ KV)        (ä»…è®¡ç®—æ–°å¢éƒ¨åˆ†)
```

**å…³é”®æ¡ä»¶**: ç¼“å­˜å‘½ä¸­è¦æ±‚**å‰ç¼€å®Œå…¨ç›¸åŒ**ï¼Œä¸€ä¸ªå­—ç¬¦éƒ½ä¸èƒ½å˜ã€‚

## 3. å¸¸è§çš„ç¼“å­˜ç ´åæ¨¡å¼ä¸åæ¨¡å¼

### 3.1 LangGraph / LangChain å¸¸è§åæ¨¡å¼

è®¸å¤šå¼€å‘è€…åœ¨ä½¿ç”¨è¿™äº›æµè¡Œæ¡†æ¶æ—¶ï¼Œä¼šä¸è‡ªè§‰åœ°é‡‡ç”¨ç ´åç¼“å­˜çš„æ¨¡å¼ï¼š

#### åæ¨¡å¼ 1: çŠ¶æ€æ³¨å…¥åˆ° System Prompt

```python
def build_system_prompt(state: dict) -> str:
    return f"""You are an assistant. Current state:
    - Step: {state['current_step']}
    - Progress: {state['progress']}%
    - Context: {state['context']}
    """

response = client.chat(
    system=build_system_prompt(state),  # æ¯æ¬¡éƒ½ä¸åŒ!
    messages=messages
)
```

**é—®é¢˜**: æ¯è½® state éƒ½å˜ï¼Œsystem prompt æ¯æ¬¡éƒ½ä¸åŒï¼Œ**ç¼“å­˜ 100% å¤±æ•ˆ**ã€‚

**æ­£ç¡®åšæ³•**ï¼š
```python
FIXED_SYSTEM_PROMPT = "You are an assistant."  # å›ºå®šä¸å˜

messages.append({
    "role": "user",
    "content": f"Current state: step={state['current_step']}, progress={state['progress']}%"
})

response = client.chat(
    system=FIXED_SYSTEM_PROMPT,  # æ°¸è¿œä¸å˜ï¼Œç¼“å­˜æœ‰æ•ˆ
    messages=messages  # åªè¿½åŠ 
)
```

#### åæ¨¡å¼ 2: æ¶ˆæ¯å‹ç¼©ä¸æ‘˜è¦æ›¿æ¢

```python
def compress_messages(messages: list) -> list:
    if len(messages) > 20:
        old_messages = messages[:15]
        summary = summarize(old_messages)
        # ç”¨æ‘˜è¦æ›¿æ¢æ—§æ¶ˆæ¯
        return [{"role": "system", "content": summary}] + messages[15:]
    return messages

messages = compress_messages(messages)  # å‰ç¼€å˜äº†ï¼Œç¼“å­˜å¤±æ•ˆ!
```

**é—®é¢˜**: æ›¿æ¢æ“ä½œæ”¹å˜äº†å‰ç¼€ï¼Œä¹‹å‰çš„æ‰€æœ‰ç¼“å­˜å¤±æ•ˆã€‚

**æˆæœ¬å½±å“** (50 è½®å¯¹è¯ï¼Œæ¯è½® 50K ä¸Šä¸‹æ–‡):
- æ— å‹ç¼©: é¦–æ¬¡ $0.1875 (å†™å…¥) + åç»­ 49 è½® Ã— $0.015 = **$0.92**
- å‹ç¼©æ›¿æ¢ (æ¯ 20 è½®): 3 æ¬¡é‡å»ºç¼“å­˜ Ã— $0.1875 = **$0.56** (çœ‹ä¼¼æ›´ä¾¿å®œ)
- **å®é™…**: å‹ç¼©åä¸¢å¤±ä¸Šä¸‹æ–‡ï¼Œæ¨¡å‹è¡¨ç°ä¸‹é™ï¼Œéœ€è¦æ›´å¤šè½®æ¬¡ï¼Œ**æ€»æˆæœ¬åè€Œæ›´é«˜**

**æ­£ç¡®åšæ³•**: ä½¿ç”¨å­ Agent éš”ç¦»ä¸Šä¸‹æ–‡ï¼Œåªè¿”å›æ‘˜è¦ç»“æœã€‚

#### åæ¨¡å¼ 3: æ»‘åŠ¨çª—å£æˆªæ–­

```python
def sliding_window(messages: list, window_size: int = 10) -> list:
    if len(messages) > window_size:
        return messages[-window_size:]  # åªä¿ç•™æœ€è¿‘ 10 æ¡
    return messages
```

**é—®é¢˜**: åˆ é™¤æ—§æ¶ˆæ¯ = æ”¹å˜å‰ç¼€ = ç¼“å­˜å¤±æ•ˆã€‚

**æˆæœ¬å¯¹æ¯”** (Claude Sonnet 4.5ï¼Œ30 è½®å¯¹è¯ï¼Œæ¯è½® 3K æ–°å¢):

| ç­–ç•¥ | Token è®¡ç®— | æˆæœ¬ |
|------|-----------|------|
| åªè¿½åŠ  | é¦–æ¬¡ 8K + 29 è½® Ã— 3K (ç¼“å­˜) = 8K + 87K (ç¼“å­˜) | $0.030 + $0.026 = **$0.056** |
| æ»‘åŠ¨çª—å£ (10 æ¡) | æ¯è½®é‡ç®— 30K | 30 è½® Ã— 30K Ã— $3/M = **$2.70** |
| **æˆæœ¬å·®è·** | | **48å€** |

#### åæ¨¡å¼ 4: æ¶ˆæ¯ç¼–è¾‘ä¸æ’å…¥

```python
def fix_message_format(messages: list) -> list:
    for msg in messages:
        if 'timestamp' in msg:
            del msg['timestamp']  # ä¿®æ”¹äº†å†å²æ¶ˆæ¯
        if msg['role'] == 'assistant' and 'tool_calls' in msg:
            msg['content'] = msg['content'].strip()  # ä¿®æ”¹å†…å®¹
    return messages
```

**é—®é¢˜**: å³ä½¿æ˜¯å¾®å°çš„ä¿®æ”¹ï¼ˆåˆ é™¤å­—æ®µã€trim ç©ºæ ¼ï¼‰ï¼Œä¹Ÿä¼šä½¿ç¼“å­˜å¤±æ•ˆã€‚

#### åæ¨¡å¼ 5: LangGraph çŠ¶æ€ç®¡ç†ä¸å½“

```python
from langgraph.graph import StateGraph

class AgentState(TypedDict):
    messages: list[BaseMessage]
    context: str
    step: int

def node_a(state: AgentState) -> AgentState:
    # é”™è¯¯: ä¿®æ”¹äº† messages
    state["messages"][0].content += f"\n[Step {state['step']}]"
    return state

graph = StateGraph(AgentState)
graph.add_node("a", node_a)
```

**é—®é¢˜**: åœ¨ LangGraph èŠ‚ç‚¹ä¸­ä¿®æ”¹å†å²æ¶ˆæ¯ï¼Œä¼šå¯¼è‡´åç»­æ‰€æœ‰èŠ‚ç‚¹çš„ç¼“å­˜å¤±æ•ˆã€‚

**æ­£ç¡®åšæ³•**: åœ¨ LangGraph ä¸­ï¼Œå°†çŠ¶æ€ä¿¡æ¯ä½œä¸º**æ–°æ¶ˆæ¯è¿½åŠ **ï¼Œè€Œéä¿®æ”¹ç°æœ‰æ¶ˆæ¯ã€‚

### 3.2 ç¼“å­˜ç ´åæ¨¡å¼æ€»ç»“

| åæ¨¡å¼ | è¡¨ç° | ç¼“å­˜å½±å“ | æˆæœ¬å€æ•° |
|--------|------|----------|----------|
| åŠ¨æ€ System Prompt | æ¯è½®æ³¨å…¥çŠ¶æ€ | 100% å¤±æ•ˆ | **20-50x** |
| æ¶ˆæ¯å‹ç¼©æ›¿æ¢ | ç”¨æ‘˜è¦æ›¿æ¢å†å² | æ›¿æ¢ç‚¹åå…¨å¤±æ•ˆ | **5-15x** |
| æ»‘åŠ¨çª—å£ | åˆ é™¤æ—§æ¶ˆæ¯ | 100% å¤±æ•ˆ | **30-50x** |
| æ¶ˆæ¯ç¼–è¾‘ | ä¿®æ”¹å†å²å†…å®¹ | ä¿®æ”¹ç‚¹åå…¨å¤±æ•ˆ | **10-30x** |
| æ¶ˆæ¯æ’å…¥ | åœ¨ä¸­é—´æ’å…¥ | æ’å…¥ç‚¹åå…¨å¤±æ•ˆ | **10-30x** |
| å¤š Agent å…¨è¿æ¥ | æ¯ä¸ª Agent çœ‹åˆ°æ‰€æœ‰æ¶ˆæ¯ | ä¸Šä¸‹æ–‡è†¨èƒ€ | **3-4x** (ç›¸å¯¹å•Agent) |

### 3.3 ä¸ºä»€ä¹ˆè¿™äº›æ¨¡å¼å¦‚æ­¤å¸¸è§ï¼Ÿ

1. **ä¼ ç»Ÿç¼–ç¨‹ä¹ æƒ¯**: åœ¨å¸¸è§„è½¯ä»¶ä¸­ï¼Œç¼–è¾‘ã€æ’å…¥ã€åˆ é™¤æ˜¯æ­£å¸¸æ“ä½œ
2. **æ¡†æ¶è¯¯å¯¼**: ä¸€äº› Agent æ¡†æ¶æä¾›äº†"æ–¹ä¾¿çš„"æ¶ˆæ¯ç®¡ç† APIï¼Œä½†æ²¡æœ‰è­¦å‘Šç¼“å­˜å½±å“
3. **ç¼ºä¹å¯è§æ€§**: å¤§éƒ¨åˆ† API ä¸æ˜¾ç¤ºç¼“å­˜å‘½ä¸­ç‡ï¼Œå¼€å‘è€…çœ‹ä¸åˆ°æˆæœ¬å·®å¼‚
4. **ç¤ºä¾‹ä»£ç **: è®¸å¤šæ•™ç¨‹å’Œç¤ºä¾‹ä»£ç ä¸ºäº†"ç®€æ´"è€Œå¿½ç•¥äº†ç¼“å­˜æœ€ä½³å®è·µ

### 3.4 å¦‚ä½•æ£€æµ‹ä½ æ˜¯å¦åœ¨ç ´åç¼“å­˜ï¼Ÿ

**Claude API å“åº”å¤´**:
```json
{
  "usage": {
    "input_tokens": 50000,
    "cache_creation_input_tokens": 48000,  // é¦–æ¬¡å†™å…¥ç¼“å­˜
    "cache_read_input_tokens": 48000,      // åç»­å‘½ä¸­
    "output_tokens": 150
  }
}
```

**å¦‚æœä½ çœ‹åˆ°**:
- `cache_read_input_tokens` å§‹ç»ˆä¸º 0 â†’ ç¼“å­˜ä»æœªå‘½ä¸­
- `cache_creation_input_tokens` æ¯æ¬¡éƒ½å¾ˆå¤§ â†’ ä½ åœ¨ç ´åç¼“å­˜

**OpenAI / Kimi K2 / GLM (è‡ªåŠ¨ç¼“å­˜)**:
```json
{
  "usage": {
    "prompt_tokens": 50000,
    "prompt_tokens_details": {
      "cached_tokens": 48000  // ç¼“å­˜å‘½ä¸­çš„ token æ•°
    }
  }
}
```

**å¦‚æœä½ çœ‹åˆ°**:
- `cached_tokens` ä¸º 0 æˆ–å¾ˆå° â†’ ç¼“å­˜æœªç”Ÿæ•ˆ

## 4. ä¸»æµæ¨¡å‹ç¼“å­˜ç­–ç•¥è¯¦è§£

### 4.1 Claude (Anthropic)

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ˜¯å¦è‡ªåŠ¨ç¼“å­˜** | **å¦**ï¼Œå¿…é¡»æ˜¾å¼ä½¿ç”¨ `cache_control` å‚æ•° |
| **æœ€å¤§æ–­ç‚¹æ•°** | æ¯ä¸ªè¯·æ±‚æœ€å¤š 4 ä¸ª cache breakpoint |
| **TTL (ç”Ÿå­˜æ—¶é—´)** | é»˜è®¤ 5 åˆ†é’Ÿï¼Œå¯é€‰ 1 å°æ—¶ (ä»·æ ¼æ›´é«˜) |
| **æœ€å° token è¦æ±‚** | Opus 4.5: 1,024 tokens; Sonnet 4.5: 1,024 tokens; Haiku 4.5: 4,096 tokens |
| **ç¼“å­˜å±‚çº§** | tools â†’ system â†’ messages (ä¿®æ”¹ä»»ä¸€å±‚çº§ä¼šä½¿åç»­å±‚çº§ç¼“å­˜å¤±æ•ˆ) |
| **Lookback çª—å£** | æ¯ä¸ªæ–­ç‚¹å‘å‰æœ€å¤šæ£€æŸ¥ 20 ä¸ª blocks å¯»æ‰¾æœ€é•¿å¯å‘½ä¸­å‰ç¼€ |

**å®šä»· (USD/M tokens)**:

| æ¨¡å‹ | è¾“å…¥ | ç¼“å­˜å†™å…¥(5min) | ç¼“å­˜å†™å…¥(1hr) | ç¼“å­˜è¯»å– | è¾“å‡º |
|------|------|----------------|---------------|----------|------|
| Claude Sonnet 4.5 | $3.00 | $3.75 (1.25x) | $6.00 (2x) | $0.30 (0.1x) | $15.00 |
| Claude Opus 4.5 | $5.00 | $6.25 (1.25x) | $10.00 (2x) | $0.50 (0.1x) | $25.00 |
| Claude Haiku 4.5 | $1.00 | $1.25 (1.25x) | $2.00 (2x) | $0.10 (0.1x) | $5.00 |

**ä½¿ç”¨æ–¹æ³•**:

```json
{
  "system": [
    {
      "type": "text",
      "text": "You are a coding assistant...",
      "cache_control": {"type": "ephemeral"}
    }
  ]
}
```

**å…³é”®æ´å¯Ÿ**:
- Claude çš„ç¼“å­˜**ä¸æ˜¯è‡ªåŠ¨çš„**ã€‚å¦‚æœä½ ä¸æ˜¾å¼è®¾ç½® `cache_control`ï¼Œå³ä½¿å‰ç¼€å®Œå…¨ç›¸åŒä¹Ÿä¸ä¼šæœ‰ç¼“å­˜å‘½ä¸­
- æ¯æ¬¡ç¼“å­˜å‘½ä¸­ä¼š**è‡ªåŠ¨åˆ·æ–° TTL**ï¼Œä¸”ä¸é¢å¤–æ”¶è´¹
- ä¿®æ”¹ system prompt ä¼šä½¿ system å’Œåç»­ messages ç¼“å­˜å¤±æ•ˆï¼Œä½† tools ç¼“å­˜ä»ä¿ç•™

### 4.2 Kimi K2 (Moonshot AI)

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ˜¯å¦è‡ªåŠ¨ç¼“å­˜** | **æ˜¯**ï¼Œç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹é‡å¤å‰ç¼€ (æ— éœ€ä»£ç ä¿®æ”¹) |
| **ä¸Šä¸‹æ–‡çª—å£** | 256K tokens (kimi-k2-0905 ç‰ˆæœ¬ï¼Œ2025å¹´9æœˆæ›´æ–°) |
| **TTL** | è‡ªåŠ¨ç¼“å­˜: æœªå…¬å¼€; æ˜¾å¼ç¼“å­˜: ç”¨æˆ·å¯è®¾ç½® (æ”¯æŒåˆ·æ–°) |
| **å‹å·** | `kimi-k2-0905` (Instruct ç‰ˆæœ¬) |

**å®šä»· (CNY/M tokens)**:

| ç±»å‹ | ä»·æ ¼ (CNY) | ä»·æ ¼ (USD çº¦) | è¯´æ˜ |
|------|------------|---------------|------|
| è¾“å…¥ (cache miss) | Â¥4.20 | ~$0.60 | æ ‡å‡†è¾“å…¥ä»· |
| è¾“å…¥ (cache hit) | Â¥0.42 | ~$0.06 | **90% æŠ˜æ‰£** |
| è¾“å‡º | Â¥17.50 | ~$2.50 | - |

**ç‰¹ç‚¹**:
- Kimi K2 çš„è‡ªåŠ¨ç¼“å­˜æ˜¯**å…¨è‡ªåŠ¨**çš„ï¼Œæ— éœ€ä»»ä½•ä»£ç ä¿®æ”¹
- ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹ç›¸åŒå‰ç¼€å¹¶å¤ç”¨ç¼“å­˜ï¼Œç¼“å­˜å‘½ä¸­æ—¶äº«å— **90% æŠ˜æ‰£**
- å®˜æ–¹ç§°å¯é™ä½é•¿æ–‡æœ¬æˆæœ¬æœ€é«˜ 90%ï¼Œé¦– Token å»¶è¿Ÿé™ä½ 83%

**æ˜¾å¼ç¼“å­˜ API (Context Cachingï¼Œå…¬æµ‹ä¸­)**:
- ç¼“å­˜åˆ›å»ºè´¹: Â¥24/M tokens (~$3.30)
- å­˜å‚¨è´¹ç”¨: Â¥5/M tokens/åˆ†é’Ÿ (2024å¹´8æœˆé™ä»·50%å)
- æ¯æ¬¡å‘½ä¸­è°ƒç”¨è´¹: Â¥0.02/æ¬¡
- åˆæœŸä»…é™ Tier5 ç”¨æˆ·ï¼Œåå¼€æ”¾å…¬æµ‹

### 4.3 GLM-4.7 (æ™ºè°± AI)

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ˜¯å¦è‡ªåŠ¨ç¼“å­˜** | **æ˜¯**ï¼Œè‡ªåŠ¨å‰ç¼€åŒ¹é… (éœ€æŒ‰ Context Caching ç”¨æ³•ç»„ç»‡ä¸Šä¸‹æ–‡) |
| **ä¸Šä¸‹æ–‡çª—å£** | 200K tokens (æ”¯æŒæœ€é«˜ 128K è¾“å‡º) |
| **TTL** | å®˜æ–¹æœªå…¬å¼€ï¼Œæè¿°ä¸º"æœ‰åˆç†çš„æ—¶é—´é™åˆ¶ï¼Œè¿‡æœŸåé‡æ–°è®¡ç®—" |
| **å‘å¸ƒæ—¥æœŸ** | 2025å¹´12æœˆ22æ—¥ (å¼€æº) |

**å®šä»· (USD/M tokens)**:

| ç±»å‹ | ä»·æ ¼ | è¯´æ˜ |
|------|------|------|
| è¾“å…¥ (æ–° token) | $0.60 | æ ‡å‡†è¾“å…¥ä»· |
| è¾“å…¥ (ç¼“å­˜å‘½ä¸­) | $0.11 | **82% æŠ˜æ‰£** |
| è¾“å‡º | $2.20 | - |
| ç¼“å­˜å­˜å‚¨ | å…è´¹ | **é™æ—¶å…è´¹**ï¼Œåç»­å¯èƒ½æ”¶è´¹ |

**ç‰¹ç‚¹**:
- GLM-4.7 æä¾› **82% çš„ç¼“å­˜æŠ˜æ‰£**ï¼Œæ˜¯å›½äº§æ¨¡å‹ä¸­æŠ˜æ‰£åŠ›åº¦è¾ƒå¤§çš„
- å“åº”ä¸­è¿”å› `usage.prompt_tokens_details.cached_tokens` ç”¨äºè¿½è¸ªç¼“å­˜å‘½ä¸­
- æ™ºè°±åŒæ—¶æä¾›å¼€æºç‰ˆæœ¬ï¼Œæœ¬åœ°éƒ¨ç½²å¯é¿å…æŒ‰ token è®¡è´¹
- åœ¨ç¼–ç¨‹è¯„æµ‹ä¸­è¡¨ç°æ¥è¿‘ Claude Sonnet 4.5 å’Œ GPT-5.2

### 4.4 MiniMax M2.1

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ˜¯å¦è‡ªåŠ¨ç¼“å­˜** | **å¦**ï¼Œéœ€è¦ä½¿ç”¨ `cache_control` å‚æ•° (ä¸ Claude ç±»ä¼¼) |
| **ä¸Šä¸‹æ–‡çª—å£** | 200K+ tokens |
| **TTL** | 5 åˆ†é’Ÿ (å‘½ä¸­æ—¶è‡ªåŠ¨åˆ·æ–°ï¼Œä¸é¢å¤–æ”¶è´¹) |
| **å‘å¸ƒæ—¥æœŸ** | 2025å¹´12æœˆ22æ—¥ (å¼€æº) |
| **ç¼“å­˜å±‚çº§** | tools â†’ system â†’ messages |
| **æœ€å¤§æ–­ç‚¹æ•°** | 4 ä¸ª `cache_control` |

**å®šä»· (USD/M tokens)**:

| ç±»å‹ | ä»·æ ¼ | è¯´æ˜ |
|------|------|------|
| è¾“å…¥ | $0.30 | æ ‡å‡†è¾“å…¥ä»· |
| ç¼“å­˜å†™å…¥ | $0.375 | 1.25x è¾“å…¥ä»· |
| ç¼“å­˜è¯»å– | $0.03 | **0.1x è¾“å…¥ä»· (90% æŠ˜æ‰£)** |
| è¾“å‡º | $1.20 | - |

**ç‰¹ç‚¹**:
- MiniMax M2.1 æ˜¯ç›®å‰**æœ€ä¾¿å®œçš„é«˜æ€§èƒ½æ¨¡å‹ä¹‹ä¸€**
- ç¼“å­˜è¯»å–ä»… $0.03/Mï¼Œæ˜¯ Claude Sonnet çš„ 1/10
- é‡‡ç”¨ MoE æ¶æ„ (230B æ€»å‚æ•°ï¼Œ10B æ¿€æ´»)ï¼Œä¸“ä¸ºä»£ç å’Œ Agent åœºæ™¯ä¼˜åŒ–
- ç¼“å­˜æœºåˆ¶ä¸ Claude é«˜åº¦ç›¸ä¼¼ (cache_control, TTL, å±‚çº§)
- æä¾› M2.1-lightning é«˜é€Ÿç‰ˆæœ¬ï¼Œè¾“å‡ºä»· $2.4/M

### 4.5 GPT-5.2 (OpenAI)

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **æ˜¯å¦è‡ªåŠ¨ç¼“å­˜** | **æ˜¯**ï¼Œæ— éœ€ä»£ç ä¿®æ”¹ï¼Œè‡ªåŠ¨é’ˆå¯¹é‡å¤å‰ç¼€ |
| **ä¸Šä¸‹æ–‡çª—å£** | 256K-400K tokens |
| **TTL** | é»˜è®¤ 5-10 åˆ†é’Ÿï¼Œéƒ¨åˆ†æ¨¡å‹æ”¯æŒæ‰©å±•è‡³ 24 å°æ—¶ |
| **æœ€å° token è¦æ±‚** | â‰¥1024 tokens è‡ªåŠ¨å¯ç”¨ |

**å®šä»· (USD/M tokens)**:

| ç±»å‹ | ä»·æ ¼ | è¯´æ˜ |
|------|------|------|
| è¾“å…¥ | $1.75 | æ ‡å‡†è¾“å…¥ä»· |
| ç¼“å­˜è¯»å– | $0.175 | **0.1x è¾“å…¥ä»· (90% æŠ˜æ‰£)** |
| è¾“å‡º | $14.00 | - |

**ç‰¹ç‚¹**:
- OpenAI çš„ç¼“å­˜æ˜¯**å…¨è‡ªåŠ¨**çš„ï¼Œæ— éœ€ä»»ä½•å‚æ•°é…ç½®
- å¯é€‰ `prompt_cache_key` å’Œ `prompt_cache_retention` å‚æ•°è¿›è¡Œç²¾ç»†æ§åˆ¶
- å®˜æ–¹ç§°å¯é™ä½è¾“å…¥æˆæœ¬æœ€é«˜ 90%ã€å»¶è¿Ÿæœ€é«˜ 80%

**æ³¨æ„**ï¼šGPT-4o ç­‰ 2024 å¹´æ¨¡å‹ç¼“å­˜æŠ˜æ‰£ä¸º 50%ï¼ŒGPT-5 ç³»åˆ—ä¸º 90%

### 4.6 Gemini 3 (Google)

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **éšå¼ç¼“å­˜** | **æ˜¯** (Gemini 2.5+ é»˜è®¤å¯ç”¨)ï¼Œè‡ªåŠ¨æ£€æµ‹é‡å¤å‰ç¼€ |
| **æ˜¾å¼ç¼“å­˜** | éœ€è¦åˆ›å»º `CachedContent` å¯¹è±¡å¹¶å¼•ç”¨ |
| **ä¸Šä¸‹æ–‡çª—å£** | Flash: 1M tokens; Pro: 1M-2M tokens |
| **TTL** | æ˜¾å¼ç¼“å­˜é»˜è®¤ 1 å°æ—¶ï¼Œå¯è‡ªå®šä¹‰ |
| **æœ€å° token è¦æ±‚** | Gemini 3 Pro: 4096; Gemini 2.5 Flash: 1024 |

**å®šä»· (USD/M tokens)**:

| æ¨¡å‹ | è¾“å…¥ | ç¼“å­˜è¯»å– | è¾“å‡º | å­˜å‚¨è´¹ |
|------|------|----------|------|--------|
| Gemini 3 Flash | $0.50 | $0.05 (0.1x) | $3.00 | $1.00/MÂ·hour |
| Gemini 3 Pro | $2.00 | $0.20 (0.1x) | $12.00 | $1.00/MÂ·hour |

**ç‰¹ç‚¹**:
- éšå¼ç¼“å­˜è‡ªåŠ¨ç”Ÿæ•ˆï¼Œä½†ä¸ä¿è¯æ¯æ¬¡éƒ½å‘½ä¸­ (é«˜å¹¶å‘æ—¶å¯èƒ½æº¢å‡º)
- æ˜¾å¼ç¼“å­˜éœ€è¦åˆ›å»ºç¼“å­˜å¯¹è±¡ï¼Œä½†å¯ç¡®ä¿å‘½ä¸­
- æ˜¾å¼ç¼“å­˜æœ‰**å­˜å‚¨è´¹**ï¼ŒæŒ‰ tokenÂ·å°æ—¶è®¡è´¹
- æ”¯æŒè¶…é•¿ä¸Šä¸‹æ–‡ (1M-2M)ï¼Œé€‚åˆå¤„ç†æ•´æœ¬ä¹¦æˆ–å¤§å‹ä»£ç åº“

### 4.7 ç»¼åˆå¯¹æ¯”

| æ¨¡å‹ | ä¸Šä¸‹æ–‡ | æ ‡å‡†è¾“å…¥ | ç¼“å­˜è¯»å– | ç¼“å­˜æŠ˜æ‰£ | è‡ªåŠ¨ç¼“å­˜ |
|------|--------|----------|----------|----------|----------|
| Claude Sonnet 4.5 | 200K | $3.00/M | $0.30/M | 90% | å¦ (éœ€ cache_control) |
| Claude Opus 4.5 | 200K | $5.00/M | $0.50/M | 90% | å¦ |
| GPT-5.2 | 256K+ | $1.75/M | $0.175/M | 90% | **æ˜¯** |
| Gemini 3 Flash | 1M | $0.50/M | $0.05/M | 90% | æ˜¯ (éšå¼) |
| Gemini 3 Pro | 1M+ | $2.00/M | $0.20/M | 90% | æ˜¯ (éšå¼) |
| Kimi K2 | 256K | ~$0.60/M | ~$0.06/M | 90% | **æ˜¯** |
| GLM-4.7 | 200K | $0.60/M | $0.11/M | 82% | æ˜¯ |
| MiniMax M2.1 | 200K | $0.30/M | $0.03/M | 90% | å¦ (éœ€ cache_control) |

## 5. è¯¦ç»†æˆæœ¬è®¡ç®—ï¼š50 è½® SWE ä»»åŠ¡å®ä¾‹

æœ¬èŠ‚é€šè¿‡ä¸€ä¸ªå…¸å‹çš„è½¯ä»¶å·¥ç¨‹ Agent ä»»åŠ¡ï¼Œé€è½®è®¡ç®— token æ¶ˆè€—å’Œæˆæœ¬ï¼Œå±•ç¤ºç¼“å­˜ä¼˜åŒ–çš„çœŸå®å½±å“ã€‚

### 5.1 ä»»åŠ¡åœºæ™¯è®¾å®š

**ä»»åŠ¡**: ä¿®å¤ä¸€ä¸ªæ¶‰åŠå¤šæ–‡ä»¶çš„ bugï¼Œéœ€è¦è¯»å–ä»£ç ã€åˆ†æã€ä¿®æ”¹ã€æµ‹è¯•

**Agent é…ç½®**:
- System prompt: 5,000 tokens
- å·¥å…·å®šä¹‰ (bash, read_file, write_file, grep, etc.): 3,000 tokens
- åŸºç¡€ä¸Šä¸‹æ–‡: 8,000 tokens

**æ¯è½®å…¸å‹æ“ä½œ**:
- ç”¨æˆ·æŒ‡ä»¤: 200 tokens
- æ¨¡å‹æ¨ç† + å·¥å…·è°ƒç”¨: 500 tokens
- å·¥å…·è¿”å› (ä»£ç ã€æµ‹è¯•ç»“æœç­‰): 2,000 tokens (å¹³å‡)
- æ¨¡å‹å“åº”: 800 tokens

### 5.2 åœºæ™¯ A: ç ´åç¼“å­˜ (åŠ¨æ€ System Prompt)

**é”™è¯¯åšæ³•**: æ¯è½®å°†å½“å‰çŠ¶æ€æ³¨å…¥ system prompt

```python
def build_system_prompt(step: int, context: dict) -> str:
    return f"""You are a coding assistant.
Current step: {step}
Files modified: {context['files']}
Tests passed: {context['tests_passed']}
...(total 5,000 tokens)"""
```

**é€è½®æˆæœ¬è®¡ç®—** (Claude Sonnet 4.5, $3/M è¾“å…¥):

| è½®æ¬¡ | ä¸Šä¸‹æ–‡ç´¯è®¡ | System å˜åŒ– | ç¼“å­˜çŠ¶æ€ | è®¡ç®— tokens | æˆæœ¬ |
|------|-----------|------------|---------|-------------|------|
| 1 | 8K + 3.5K = 11.5K | âœ— | æ— ç¼“å­˜ | 11.5K | $0.0345 |
| 2 | 11.5K + 3.5K = 15K | âœ— | å®Œå…¨å¤±æ•ˆ | 15K | $0.0450 |
| 3 | 15K + 3.5K = 18.5K | âœ— | å®Œå…¨å¤±æ•ˆ | 18.5K | $0.0555 |
| ... | ... | ... | ... | ... | ... |
| 50 | 8K + 49Ã—3.5K = 179.5K | âœ— | å®Œå…¨å¤±æ•ˆ | 179.5K | $0.5385 |

**æ€»æˆæœ¬ (50 è½®)**:
```
Sum(8K + nÃ—3.5K) for n=0 to 49
= 50Ã—8K + 3.5KÃ—(0+1+2+...+49)
= 400K + 3.5K Ã— 1,225
= 400K + 4,287.5K
= 4,687.5K tokens Ã— $3/M = $14.06
```

### 5.3 åœºæ™¯ B: ç¼“å­˜ä¼˜åŒ– (å›ºå®š System Prompt)

**æ­£ç¡®åšæ³•**: System prompt å›ºå®šï¼ŒçŠ¶æ€ä½œä¸ºæ–°æ¶ˆæ¯è¿½åŠ 

```python
FIXED_SYSTEM_PROMPT = "You are a coding assistant. (5,000 tokens)"

# æ¯è½®è¿½åŠ çŠ¶æ€ä¿¡æ¯
messages.append({
    "role": "user",
    "content": f"Status update: step={step}, files={files}..."
})
```

**ä½¿ç”¨ Claude cache_control**:

```python
system = [{
    "type": "text",
    "text": FIXED_SYSTEM_PROMPT,
    "cache_control": {"type": "ephemeral"}
}]
```

**é€è½®æˆæœ¬è®¡ç®—**:

| è½®æ¬¡ | ä¸Šä¸‹æ–‡ç´¯è®¡ | ç¼“å­˜å†™å…¥ | ç¼“å­˜è¯»å– | æ–°å¢è®¡ç®— | æˆæœ¬ |
|------|-----------|---------|---------|---------|------|
| 1 | 11.5K | 8K @ $3.75/M | 0 | 3.5K @ $3/M | $0.030 + $0.0105 = $0.0405 |
| 2 | 15K | 0 | 11.5K @ $0.30/M | 3.5K @ $3/M | $0.00345 + $0.0105 = $0.01395 |
| 3 | 18.5K | 0 | 15K @ $0.30/M | 3.5K @ $0.30/M | $0.0045 + $0.0105 = $0.0150 |
| ... | ... | ... | ... | ... | ... |
| 50 | 179.5K | 0 | 176K @ $0.30/M | 3.5K @ $3/M | $0.0528 + $0.0105 = $0.0633 |

**æ€»æˆæœ¬ (50 è½®)**:
```
é¦–è½®: 8KÃ—$3.75/M + 3.5KÃ—$3/M = $0.030 + $0.0105 = $0.0405
åç»­ 49 è½®:
  - ç¼“å­˜è¯»å–: (11.5K + 15K + ... + 176K) Ã— $0.30/M
  - æ–°å¢è®¡ç®—: 49 Ã— 3.5K Ã— $3/M = 171.5K Ã— $3/M = $0.5145

ç¼“å­˜è¯»å–ç´¯è®¡:
  Sum(8K + nÃ—3.5K) for n=1 to 49 = 4,287.5K Ã— $0.30/M = $1.29

æ€»è®¡: $0.0405 + $1.29 + $0.5145 = $1.845
```

**èŠ‚çœ**: ($14.06 - $1.845) / $14.06 = **86.9%**

### 5.4 åœºæ™¯ C: ä½¿ç”¨å›½äº§æ¨¡å‹ (Kimi K2 è‡ªåŠ¨ç¼“å­˜)

**ä»·æ ¼**: $0.60/M è¾“å…¥ (æ ‡å‡†)ï¼Œ$0.15/M è¾“å…¥ (ç¼“å­˜å‘½ä¸­)

**é€è½®æˆæœ¬è®¡ç®—**:

| è½®æ¬¡ | ä¸Šä¸‹æ–‡ç´¯è®¡ | ç¼“å­˜å‘½ä¸­ | æ–°å¢è®¡ç®— | æˆæœ¬ |
|------|-----------|---------|---------|------|
| 1 | 11.5K | 0 | 11.5K @ $0.60/M | $0.0069 |
| 2 | 15K | 11.5K @ $0.15/M | 3.5K @ $0.60/M | $0.001725 + $0.0021 = $0.003825 |
| 3 | 18.5K | 15K @ $0.15/M | 3.5K @ $0.60/M | $0.00225 + $0.0021 = $0.00435 |
| ... | ... | ... | ... | ... |
| 50 | 179.5K | 176K @ $0.15/M | 3.5K @ $0.60/M | $0.0264 + $0.0021 = $0.0285 |

**æ€»æˆæœ¬ (50 è½®)**:
```
é¦–è½®: 11.5K Ã— $0.60/M = $0.0069
åç»­ 49 è½®:
  - ç¼“å­˜å‘½ä¸­: 4,287.5K Ã— $0.15/M = $0.643
  - æ–°å¢è®¡ç®—: 49 Ã— 3.5K Ã— $0.60/M = $0.1029

æ€»è®¡: $0.0069 + $0.643 + $0.1029 = $0.753
```

**ç›¸æ¯” Claude æ— ç¼“å­˜**: ($14.06 - $0.753) / $14.06 = **94.6% èŠ‚çœ**

### 5.5 åœºæ™¯ D: æ»‘åŠ¨çª—å£åæ¨¡å¼

**é”™è¯¯åšæ³•**: ä¿ç•™æœ€è¿‘ 10 è½®å¯¹è¯ï¼Œåˆ é™¤æ—§çš„

**æ¯è½®éƒ½éœ€è¦é‡æ–°è®¡ç®—** (å› ä¸ºå‰ç¼€ä¸€ç›´åœ¨å˜):

| è½®æ¬¡ | ä¸Šä¸‹æ–‡ | è®¡ç®— tokens | æˆæœ¬ (Claude) |
|------|--------|-------------|---------------|
| 1-10 | 8K + nÃ—3.5K | é€æ¸å¢é•¿ | é€æ¸å¢é•¿ |
| 11+ | 8K + 10Ã—3.5K = 43K | **æ¯è½® 43K** | **æ¯è½® $0.129** |

**æ€»æˆæœ¬ (50 è½®)**:
```
å‰ 10 è½®: Sum(8K + nÃ—3.5K) for n=0 to 9 = 237.5K Ã— $3/M = $0.7125
å 40 è½®: 40 Ã— 43K Ã— $3/M = 5,160K Ã— $3/M = $15.48

æ€»è®¡: $0.7125 + $15.48 = $16.19
```

**æ¯”ç¼“å­˜ä¼˜åŒ–ç‰ˆè´µ**: $16.19 / $1.845 = **8.8 å€**

### 5.6 å¤šæ¨¡å‹å¯¹æ¯”æ€»ç»“

**50 è½® SWE ä»»åŠ¡æ€»æˆæœ¬å¯¹æ¯”**:

| ç­–ç•¥ | æ¨¡å‹ | æ€»æˆæœ¬ | ç›¸å¯¹æˆæœ¬ | èŠ‚çœ |
|------|------|--------|---------|------|
| **ç ´åç¼“å­˜** | Claude Sonnet 4.5 | **$14.06** | 7.6x | åŸºå‡† |
| **æ»‘åŠ¨çª—å£** | Claude Sonnet 4.5 | **$16.19** | 8.8x | -15% (æ›´è´µ!) |
| **ç¼“å­˜ä¼˜åŒ–** | Claude Sonnet 4.5 | **$1.845** | 1.0x | **87%** |
| **ç¼“å­˜ä¼˜åŒ–** | GPT-5.2 | **$1.08** | 0.59x | **92%** |
| **è‡ªåŠ¨ç¼“å­˜** | Kimi K2 | **$0.753** | 0.41x | **95%** |
| **è‡ªåŠ¨ç¼“å­˜** | GLM-4.7 | **$0.84** | 0.46x | **94%** |
| **è‡ªåŠ¨ç¼“å­˜** | MiniMax M2.1 | **$0.38** | 0.21x | **97%** |

**å…³é”®æ´å¯Ÿ**:
1. ç ´åç¼“å­˜æ¯”ä¼˜åŒ–ç‰ˆè´µ **7-8 å€**
2. æ»‘åŠ¨çª—å£ä¸ä»…ç ´åç¼“å­˜ï¼Œè¿˜å› ä¸ºé‡å¤è®¡ç®—æ›´è´µ
3. å›½äº§æ¨¡å‹çš„è‡ªåŠ¨ç¼“å­˜ + ä½ä»·æ ¼ç»„åˆæå…·ç«äº‰åŠ›
4. MiniMax M2.1 åœ¨è¿™ä¸ªåœºæ™¯ä¸‹æˆæœ¬æœ€ä½

## 6. Agent ç¼–æ’ç­–ç•¥ä¸ç¼“å­˜å½±å“

ä¸åŒçš„ Agent ç¼–æ’ç­–ç•¥å¯¹ç¼“å­˜æœ‰ç€æˆªç„¶ä¸åŒçš„å½±å“ã€‚

### 6.1 ç¼–æ’æ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | æè¿° | ç¼“å­˜å‹å¥½åº¦ | Token æ¶ˆè€—å€æ•° |
|------|------|-----------|---------------|
| **å• Agent å¾ªç¯** | ä¸€ä¸ª Agent æŒç»­è°ƒç”¨å·¥å…·ç›´åˆ°å®Œæˆ | å¥½ | 1x (åŸºå‡†) |
| **å¤š Agent é¡ºåº** | å¤šä¸ª Agent é¡ºåºæ‰§è¡Œï¼Œä¼ é€’ç»“æœ | ä¸­ | 4-6x |
| **å¤š Agent åä½œ** | å¤šä¸ª Agent ç›¸äº’å¯¹è¯åå•† | å·® | **15x+** |
| **å±‚çº§ Agent** | çˆ¶å­å±‚çº§ç»“æ„ï¼Œå­ Agent éš”ç¦»ä¸Šä¸‹æ–‡ | å¥½ | 2-4x |
| **Graph ç¼–æ’** | DAG èŠ‚ç‚¹å¼ç¼–æ’ (LangGraph) | å¥½* | 2-4x |
| **ReAct å¾ªç¯** | Thought â†’ Action â†’ Observation å¾ªç¯ | å·® | é«˜ (æ¯è½®ç´¯ç§¯) |

*éœ€è¦æ­£ç¡®é…ç½®èŠ‚ç‚¹çº§ç¼“å­˜

**ç ”ç©¶æ•°æ®æ”¯æ’‘**:
- Anthropic ç ”ç©¶ (2025å¹´6æœˆ): å¤š Agent ç³»ç»Ÿç›¸æ¯”ç®€å•èŠå¤©æ¶ˆè€—çº¦**15å€** tokensï¼Œæ€§èƒ½æå‡90.2%
- arXiv è®ºæ–‡: éƒ¨åˆ†å¤æ‚ä»»åŠ¡åœ¨å¤š Agent æ¡†æ¶ä¸‹æ¶ˆè€—é«˜è¾¾ **200 ä¸‡ tokens**
- å­¦æœ¯ç ”ç©¶è¡¨æ˜ï¼Œå¼•å…¥ Supervisor Agent å¯å‡å°‘çº¦ 30% çš„æ— æ•ˆ token æ¶ˆè€—

**é‡è¦**: ä¸Šè¿°"15å€"æ˜¯ç›¸å¯¹äºç®€å•èŠå¤©ä»»åŠ¡ã€‚å¤šAgentç›¸å¯¹å•Agentçš„å®é™…å€æ•°çº¦ä¸º**3-4å€**ï¼Œè€Œéæ›´é«˜çš„æ•°å€¼ã€‚é€‰æ‹©å¤šAgentæ¶æ„éœ€è¦æƒè¡¡æ€§èƒ½æå‡(90%+)ä¸æˆæœ¬å¢åŠ (3-4x)ã€‚

### 6.2 ç ´åç¼“å­˜çš„æ“ä½œ

| æ“ä½œ | å½±å“ | ç»“æœ |
|------|------|------|
| **ç¼–è¾‘å†å²æ¶ˆæ¯** | æ”¹å˜å‰ç¼€ | ç¼“å­˜å®Œå…¨å¤±æ•ˆ |
| **åœ¨ä¸­é—´æ’å…¥æ¶ˆæ¯** | åç»­å‰ç¼€å˜åŒ– | æ’å…¥ç‚¹ä¹‹åéœ€é‡æ–°è®¡ç®— |
| **ä¿®æ”¹ system prompt** | æœ€å‰é¢å˜åŒ– | **æ•´ä¸ªå¯¹è¯ç¼“å­˜å¤±æ•ˆ** |
| **æ¶ˆæ¯å‹ç¼©/æ‘˜è¦æ›¿æ¢** | æ›¿æ¢åŸå§‹å†…å®¹ | å‰ç¼€å˜åŒ–ï¼Œç¼“å­˜å¤±æ•ˆ |
| **æ»‘åŠ¨çª—å£æˆªæ–­** | åˆ é™¤æ—§æ¶ˆæ¯ | å‰ç¼€å˜åŒ–ï¼Œç¼“å­˜å¤±æ•ˆ |

### 6.3 ç¼“å­˜å±‚çº§ä¸å¤±æ•ˆä¼ æ’­

Claude çš„ç¼“å­˜æŒ‰ä»¥ä¸‹é¡ºåºå¤„ç†ï¼š

```
tools å˜æ›´
    â†“ (ä½¿ä¸‹æ¸¸å…¨éƒ¨å¤±æ•ˆ)
system prompt å˜æ›´
    â†“ (ä½¿ä¸‹æ¸¸å…¨éƒ¨å¤±æ•ˆ)
messages å†…å®¹å˜æ›´
    â†“ (ä½¿è¯¥ç‚¹ä¹‹åå¤±æ•ˆ)
tool_result (ä½œä¸º user message)
    âœ“ (ä¿æŒç¼“å­˜æœ‰æ•ˆ)
```

**å…³é”®æ´å¯Ÿ**: å°†åŠ¨æ€å†…å®¹æ”¾åœ¨å¯¹è¯æœ«å°¾ï¼ˆä½œä¸º tool_result æˆ–æ–°çš„ user messageï¼‰ï¼Œè€Œä¸æ˜¯ä¿®æ”¹å‰é¢çš„å†…å®¹ã€‚è¿™æ˜¯ Claude Code å’Œ Kode CLI é‡‡ç”¨çš„ç­–ç•¥ã€‚

### 6.4 å¤š Agent çš„ Token æ¶ˆè€—é—®é¢˜

æ ¹æ® Anthropic 2025å¹´6æœˆçš„ç ”ç©¶:

| æŒ‡æ ‡ | ç®€å•èŠå¤© | å• Agent | å¤š Agent | å€æ•°å…³ç³» |
|------|---------|----------|----------|---------|
| è¾“å…¥ tokens | 1x | 4x | 15x | å¤šAgentçº¦ä¸ºå•Agentçš„**3.75x** |
| æ€§èƒ½æå‡ | åŸºå‡† | - | +90.2% | ç›¸å¯¹å•Agent |
| Tokené‡è¦æ€§ | - | - | - | Tokenä½¿ç”¨é‡è§£é‡Š80%æ€§èƒ½å·®å¼‚ |

**ç»“è®º**:
- å¤š Agent ç³»ç»Ÿç›¸æ¯”ç®€å•èŠå¤©æ¶ˆè€—çº¦**15å€** tokens
- å¤š Agent ç›¸æ¯”å• Agent çº¦**3-4å€**æ¶ˆè€—
- æ€§èƒ½æå‡90.2%ï¼Œä½†æˆæœ¬æ˜¾è‘—å¢åŠ 
- é€‚åˆé«˜ä»·å€¼ä»»åŠ¡ï¼Œå…¶æ”¶ç›Šèƒ½è¦†ç›–é¢å¤–æˆæœ¬

**ä¼˜åŒ–ç­–ç•¥**:
- ä½¿ç”¨**ç¯å½¢æ‹“æ‰‘**æˆ–**å±‚çº§ç»“æ„**è€Œéå…¨è¿æ¥ï¼Œå‡å°‘å†—ä½™ä¼ é€’
- å­ Agent é‡‡ç”¨**éš”ç¦»ä¸Šä¸‹æ–‡**ï¼Œåªè¿”å›æ‘˜è¦ç»“æœç»™çˆ¶ Agent
- é€‰æ‹©æ€§å…±äº«è€Œéå¹¿æ’­æ‰€æœ‰æ¶ˆæ¯
- é€šè¿‡prompt cachingå¤ç”¨é‡å¤çš„system promptå’Œå·¥å…·å®šä¹‰

**æ•°æ®æ¥æº**: [Anthropic: Multi-agent Research System (2025-06)](https://www.anthropic.com/engineering/multi-agent-research-system)

## 7. å…¸å‹ä»»åŠ¡çš„ Token æ¶ˆè€—

### 7.1 è½¯ä»¶å·¥ç¨‹ (SWE) ä»»åŠ¡

| æŒ‡æ ‡ | èŒƒå›´ | è¯´æ˜ |
|------|------|------|
| å•ä¸ª issue æ€»æ¶ˆè€— | 100K - 1M tokens | SWE-bench é™åˆ¶ |
| åŸºç¡€ä¸Šä¸‹æ–‡ | ~20K tokens | ç³»ç»Ÿæç¤º + å·¥å…·å®šä¹‰ |
| æ¯è½®äº¤äº’å¢é‡ | 2K - 10K tokens | å–å†³äºæ–‡ä»¶å¤§å°å’Œå·¥å…·è¾“å‡º |
| å…¸å‹ä»»åŠ¡è½®æ•° | 10 - 50 è½® | å¤æ‚ä»»åŠ¡å¯èƒ½æ›´å¤š |

**Claude Code å®é™…æ•°æ®**:
- å¹³å‡æ¯å¼€å‘è€…æ¯å¤©: $6 (90% ç”¨æˆ·ä½äº $12/å¤©)
- Pro Plan æ¯ 5 å°æ—¶: ~44,000 tokens (10-40 æ¬¡æç¤º)
- é«˜çº§å·¥å…·ä½¿ç”¨å¯å‡å°‘ 37% token æ¶ˆè€—

**SWE-bench æˆæœ¬æ¼”å˜** (Claude Sonnet):
- 2024å¹´8æœˆ (æ— ç¼“å­˜): $5.29/ä»»åŠ¡
- 2024å¹´9æœˆ (æœ‰ç¼“å­˜): $0.91/ä»»åŠ¡
- **é™å¹…: 83%**

### 7.2 æµè§ˆå™¨è‡ªåŠ¨åŒ–ä»»åŠ¡

| æŒ‡æ ‡ | èŒƒå›´ | è¯´æ˜ |
|------|------|------|
| æ¯æ¬¡æˆªå›¾ | ~1,600 tokens | Claude Vision æœ€å¤§å›¾ç‰‡ |
| æ¯ä¸ªä»»åŠ¡äº¤äº’è½®æ•° | 10 - 50 è½® | æ¯è½®åŒ…å«æˆªå›¾åˆ†æ |
| å•ä»»åŠ¡æ€»æ¶ˆè€— | 765 - 3,225 tokens | ä¸å«æˆªå›¾ |
| å®Œæ•´ä»»åŠ¡ (å«æˆªå›¾) | 20K - 100K tokens | ä¼°ç®— |

**ä¸åŒ Browser Agent æˆæœ¬å¯¹æ¯”**:

| Agent | æˆåŠŸç‡ | å¹³å‡ tokens/ä»»åŠ¡ | æˆæœ¬/ä»»åŠ¡ |
|-------|--------|------------------|-----------|
| DroidRun | 43% | 3,225 | $0.075 |
| Mobile-Agent | 29% | 1,130 | $0.025 |
| AutoDroid | 14% | 765 | $0.017 |

**Vision Token è®¡ç®—** (Claude):
```
tokens = (width Ã— height) / 750
```
æœ€å¤§å›¾ç‰‡çº¦ 1,600 tokensï¼Œç›¸å½“äº $4.80/åƒå¼ å›¾ç‰‡ (Sonnet 4.5)ã€‚

### 7.3 å·¥å…·è°ƒç”¨å¼€é”€

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| æ¯æ¡æ¶ˆæ¯å¼€é”€ | 3-6 tokens | ChatML æ ¼å¼ |
| å·¥å…·å®šä¹‰ | 100-500 tokens/å·¥å…· | å–å†³äº schema å¤æ‚åº¦ |
| å·¥å…·è¿”å›å€¼ | 800-1,500 tokens/æ¬¡ | å¹³å‡å¢é‡ï¼Œé•¿æ–‡æ¡£å¯è¾¾æ•°ä¸‡ |
| å•æ¬¡å·¥å…·è°ƒç”¨å¢é‡ | 1K-5K tokens | åŒ…å«è°ƒç”¨æè¿°å’Œè¿”å›ç»“æœ |

**Anthropic å·¥ç¨‹æ¡ˆä¾‹**:
- DevOps åŠ©ç†é¢„è½½å‡ åä¸ªå·¥å…·å®šä¹‰åï¼ŒåŸºç¡€ä¸Šä¸‹æ–‡å·²è¾¾ **50K+ tokens**
- æœªä¼˜åŒ–æ—¶ï¼Œå·¥å…·å®šä¹‰å’Œç»“æœåœ¨æç¤ºä¸­å †ç§¯å¯è¾¾ **134K tokens**
- ä¸€ä¸ª Slack æŸ¥è¯¢å·¥å…·è¿”å›å¯èƒ½æœ‰å‡ åƒ tokensï¼ŒJira æŸ¥è¯¢å¯è¾¾ä¸Šä¸‡ tokens

**ä¼˜åŒ–æ¡ˆä¾‹**: Red Sift é€šè¿‡ LLM-aware API è®¾è®¡å‡å°‘äº† **84% çš„ token æ¶ˆè€—**ï¼Œä¸”æ— è´¨é‡æŸå¤±ã€‚

### 7.4 Token æ¶ˆè€—ä¼°ç®—æ¨¡æ¿

**åœºæ™¯: 20 è½® SWE ä»»åŠ¡**

```
åŸºç¡€ä¸Šä¸‹æ–‡:
- System prompt: 5,000 tokens
- å·¥å…·å®šä¹‰: 3,000 tokens (6 ä¸ªå·¥å…· Ã— 500)
- åŸºç¡€åˆè®¡: 8,000 tokens

æ¯è½®å¢é‡ (å¹³å‡):
- ç”¨æˆ·æŒ‡ä»¤: 200 tokens
- å·¥å…·è°ƒç”¨: 500 tokens
- å·¥å…·è¿”å›: 2,000 tokens (ä»£ç æ–‡ä»¶ç­‰)
- åŠ©æ‰‹å“åº”: 800 tokens
- æ¯è½®åˆè®¡: 3,500 tokens

20 è½®æ€»æ¶ˆè€—:
- ç†è®ºæœ€å¤§: 8,000 + 20 Ã— 3,500 = 78,000 tokens
- æœ‰ç¼“å­˜æ—¶å®é™…è®¡ç®—: 8,000 (é¦–æ¬¡) + 20 Ã— 3,500 Ã— éƒ¨åˆ† â‰ˆ 40,000 tokens æ–°è®¡ç®—
```

## 8. æˆæœ¬è®¡ç®—å®ä¾‹

### 8.1 åœºæ™¯ A: æ— ç¼“å­˜æ„è¯†çš„ Agent

**å‡è®¾**:
- æ¯è½®ä¿®æ”¹ system prompt æ³¨å…¥çŠ¶æ€
- 20 è½®å·¥å…·è°ƒç”¨
- åŸºç¡€ä¸Šä¸‹æ–‡ 50K tokens

**è®¡ç®—**:
```
æ¯è½®éƒ½éœ€è¦é‡æ–°å¤„ç† 50K tokens
20 è½® Ã— 50K Ã— $3/M = $3.00 (ä»… system prompt éƒ¨åˆ†)
åŠ ä¸Šæ¯è½®å¢é‡... æ€»æˆæœ¬æ˜¾è‘—
```

### 8.2 åœºæ™¯ B: ç¼“å­˜ä¼˜åŒ–çš„ Agent

**å‡è®¾**:
- System prompt å›ºå®šä¸å˜
- å†…å®¹åªè¿½åŠ ï¼Œä¸ä¿®æ”¹
- ä½¿ç”¨ Claude çš„ cache_control

**è®¡ç®—**:
```
é¦–è½®: 50K tokens Ã— $3.75/M (ç¼“å­˜å†™å…¥) = $0.1875
åç»­ 19 è½®: 50K Ã— $0.30/M Ã— 19 = $0.285
æ€»è®¡: $0.4725

èŠ‚çœ: ($3.00 - $0.4725) / $3.00 = 84%
```

### 8.3 åœºæ™¯ C: ä½¿ç”¨å›½äº§æ¨¡å‹

**ä½¿ç”¨ GLM-4.7, ç›¸åŒä»»åŠ¡**:
```
é¦–è½®: 50K Ã— $0.60/M = $0.03
åç»­ 19 è½® (ç¼“å­˜å‘½ä¸­): 50K Ã— $0.11/M Ã— 19 = $0.1045
æ€»è®¡: $0.1345

ç›¸æ¯” Claude æ— ç¼“å­˜åœºæ™¯èŠ‚çœ: 95.5%
ç›¸æ¯” Claude æœ‰ç¼“å­˜åœºæ™¯èŠ‚çœ: 72%
```

### 8.4 å¤š Agent åœºæ™¯æˆæœ¬

**å‡è®¾**: 4 ä¸ª Agent åä½œï¼Œå…¨è¿æ¥æ¶ˆæ¯ä¼ é€’

```
å• Agent åŸºå‡†: 100K tokens
å¤š Agent (77x ç³»æ•°): 7.7M tokens

Claude Sonnet 4.5:
- å• Agent: 100K Ã— $3/M = $0.30
- å¤š Agent: 7.7M Ã— $3/M = $23.10

ä½¿ç”¨ç¯å½¢æ‹“æ‰‘ä¼˜åŒ–å:
- é¢„ä¼°å‡å°‘ 60-80%: ~$5-9
```

## 9. æœ€ä½³å®è·µ

### 9.1 ç¼“å­˜å‹å¥½çš„ Agent è®¾è®¡

```python
# æ­£ç¡®: åªè¿½åŠ ï¼Œä¸ä¿®æ”¹
messages.append({"role": "user", "content": results})

# é”™è¯¯: ç¼–è¾‘å†å²
messages[2]["content"] = "updated"  # ç¼“å­˜å¤±æ•ˆ!

# é”™è¯¯: ä¿®æ”¹ system prompt
system_prompt = f"Current state: {state}"  # æ¯æ¬¡éƒ½å˜ï¼Œç¼“å­˜å¤±æ•ˆ!

# æ­£ç¡®: çŠ¶æ€ä½œä¸ºæ–°æ¶ˆæ¯è¿½åŠ 
messages.append({"role": "user", "content": f"Current state: {state}"})
```

### 9.2 Claude ç¼“å­˜é…ç½®

```python
response = client.messages.create(
    model="claude-sonnet-4-5-20250514",
    system=[
        {
            "type": "text",
            "text": "Your long system prompt here...",
            "cache_control": {"type": "ephemeral"}  # å…³é”®!
        }
    ],
    messages=messages,
    tools=tools
)
```

### 9.3 ä¸Šä¸‹æ–‡ç®¡ç†ç­–ç•¥é€‰æ‹©

| åœºæ™¯ | æ¨èç­–ç•¥ | åŸå›  |
|------|----------|------|
| çŸ­å¯¹è¯ (<10 è½®) | åªè¿½åŠ  | ç®€å•ï¼Œç¼“å­˜å‹å¥½ |
| ä¸­ç­‰å¯¹è¯ (10-50 è½®) | åªè¿½åŠ  + å­ Agent éš”ç¦» | ä¿æŒä¸»ä¸Šä¸‹æ–‡å¹²å‡€ |
| é•¿å¯¹è¯ (>50 è½®) | åˆ†æ®µ + æ‘˜è¦ (æ¥å—ç¼“å­˜æŸå¤±) | é¿å…è¶…å‡ºä¸Šä¸‹æ–‡çª—å£ |
| å¤š Agent | ç¯å½¢æ‹“æ‰‘ + é€‰æ‹©æ€§å…±äº« | å¹³è¡¡æ€§èƒ½å’Œæˆæœ¬ |

### 9.4 æ¨¡å‹é€‰æ‹©å»ºè®®

| éœ€æ±‚ | æ¨èæ¨¡å‹ | åŸå›  |
|------|----------|------|
| æœ€é«˜è´¨é‡ | Claude Opus 4.5 | æœ€å¼ºæ¨ç†èƒ½åŠ› |
| æ€§ä»·æ¯” (æµ·å¤–) | GPT-5.2 | è‡ªåŠ¨ç¼“å­˜ï¼Œ$1.75/M è¾“å…¥ |
| æ€§ä»·æ¯” (å›½äº§) | GLM-4.7 / Kimi K2 | è‡ªåŠ¨ç¼“å­˜ï¼Œ~$0.60/M è¾“å…¥ |
| æœ€ä½æˆæœ¬ | MiniMax M2.1 | $0.03/M ç¼“å­˜è¯»å– |
| è¶…é•¿ä¸Šä¸‹æ–‡ | Gemini 3 Pro (2M) | æœ€å¤§ä¸Šä¸‹æ–‡çª—å£ |
| ç¼–ç¨‹ä¸“ç²¾ | GLM-4.7 / MiniMax M2.1 | å¼€æºå¯è‡ªéƒ¨ç½² |

## 10. æ€»ç»“

1. **ç¼“å­˜ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œä½†å€¼å¾—ç†è§£**: åˆç†åˆ©ç”¨ç¼“å­˜å¯èŠ‚çœ 50-90% æˆæœ¬

2. **Claude éœ€è¦æ˜¾å¼é…ç½®**: ä½¿ç”¨ `cache_control` å‚æ•°ï¼Œå¦åˆ™ä¸ä¼šæœ‰ç¼“å­˜

3. **å›½äº§æ¨¡å‹è‡ªåŠ¨ç¼“å­˜**: Kimi K2 å’Œ GLM-4.7 è‡ªåŠ¨æ£€æµ‹é‡å¤å‰ç¼€ï¼Œæ— éœ€é…ç½®

4. **åªè¿½åŠ æ˜¯å…³é”®**: æŠŠä¸Šä¸‹æ–‡å½“ä½œåªè¿½åŠ æ—¥å¿—ï¼Œä¸è¦ç¼–è¾‘å†å²

5. **å¤š Agent ä»£ä»·é€‚ä¸­**: ç›¸å¯¹å•Agentçº¦**3-4å€**tokenæ¶ˆè€—ï¼Œä½†æ€§èƒ½æå‡90%+ï¼Œé€‚åˆé«˜ä»·å€¼ä»»åŠ¡

6. **å…ˆè®©å®ƒå·¥ä½œï¼Œå†ä¼˜åŒ–**: è¿‡æ—©ä¼˜åŒ–å¯èƒ½å¾—ä¸å¿å¤±

## 11. æ•°æ®æ¥æºä¸å…è´£å£°æ˜

**æœ¬æ–‡æ•°æ®æ¥æº**:
1. **å®˜æ–¹æ–‡æ¡£** (Açº§): Anthropicã€OpenAIã€Googleå®˜æ–¹å®šä»·å’Œæœºåˆ¶æ–‡æ¡£
2. **å®˜æ–¹ç ”ç©¶** (Açº§): Anthropic Engineering Blogçš„å¤šAgentç ”ç©¶
3. **ç¬¬ä¸‰æ–¹æŠ¥é“** (Bçº§): å›½äº§æ¨¡å‹ä»·æ ¼å’Œç‰¹æ€§ï¼ˆå·²æ ‡æ³¨æ¥æºï¼‰
4. **å®éªŒä¼°ç®—** (Cçº§): 50è½®SWEä»»åŠ¡ç­‰åœºæ™¯ï¼ˆå·²æ ‡æ³¨å‡è®¾æ¡ä»¶ï¼‰

**é‡è¦æé†’**:
- æ‰€æœ‰ä»·æ ¼å’Œæœºåˆ¶ä»¥**å„å®¶å®˜æ–¹æ–‡æ¡£ä¸ºå‡†**ï¼Œæœ¬æ–‡ä»…ä¾›å‚è€ƒ
- è®¡ç®—ç¤ºä¾‹åŸºäºç‰¹å®šå‡è®¾ï¼ˆå¦‚è¿ç»­æ“ä½œåœ¨TTLå†…ã€å›ºå®šæ¯è½®å¢é‡ç­‰ï¼‰
- å®é™…æˆæœ¬å—ä»»åŠ¡å¤æ‚åº¦ã€ç¼“å­˜å‘½ä¸­ç‡ã€æ¨¡å‹é€‰æ‹©ç­‰å¤šå› ç´ å½±å“
- å»ºè®®åœ¨å®é™…åº”ç”¨ä¸­ç›‘æ§`usage`å­—æ®µéªŒè¯ç¼“å­˜æ•ˆæœ

**æ•°æ®æ›´æ–°æ—¥æœŸ**: 2025å¹´12æœˆ28æ—¥

æœ¬æ–‡æŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿æŒ‡æ­£å’Œè¡¥å……ã€‚

---

## å‚è€ƒèµ„æ–™

**å®˜æ–¹æ–‡æ¡£**:
- [Claude Prompt Caching](https://platform.claude.com/docs/en/build-with-claude/prompt-caching)
- [Anthropic Pricing](https://www.anthropic.com/pricing)
- [OpenAI Prompt Caching](https://platform.openai.com/docs/guides/prompt-caching)
- [OpenAI Pricing](https://openai.com/api/pricing/)
- [Gemini Context Caching](https://ai.google.dev/gemini-api/docs/caching)
- [Gemini Pricing](https://ai.google.dev/gemini-api/docs/pricing)
- [Moonshot AI Pricing](https://platform.moonshot.ai/docs/pricing/chat)
- [Moonshot Context Caching](https://platform.moonshot.cn/blog/posts/context-caching)
- [æ™ºè°± AI å®šä»·](https://open.bigmodel.cn/pricing)
- [Z.AI Context Caching](https://docs.z.ai/guides/capabilities/cache)
- [MiniMax Prompt Caching](https://platform.minimax.io/docs/api-reference/text-prompt-caching)

**ç ”ç©¶è®ºæ–‡**:
- [SWE-agent: Agent-Computer Interfaces (NeurIPS 2024)](https://proceedings.neurips.cc/paper_files/paper/2024/file/5a7c947568c1b1328ccc5230172e1e7c-Paper-Conference.pdf)
- [CodeAgents: Token-Efficient Framework](https://arxiv.org/html/2507.03254v1)
- [Rethinking Multi-Agent Through Small-World Networks](https://arxiv.org/html/2512.18094v1)
- [Stop Wasting Your Tokens: Towards Efficient Runtime Multi-Agent Systems](https://arxiv.org/html/2510.26585v1)

**å·¥ç¨‹å®è·µ**:
- [Anthropic: Effective Context Engineering for AI Agents](https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents)
- [Anthropic: Advanced Tool Use](https://www.anthropic.com/engineering/advanced-tool-use)
- [Building Agents with Claude Agent SDK](https://www.anthropic.com/engineering/building-agents-with-the-claude-agent-sdk)
- [AWS: Claude Code + Bedrock Prompt Caching](https://aws.amazon.com/blogs/machine-learning/supercharge-your-development-with-claude-code-and-amazon-bedrock-prompt-caching/)
- [Microsoft Azure SRE Agent Context Engineering](https://techcommunity.microsoft.com/blog/appsonazureblog/context-engineering-lessons-from-building-azure-sre-agent/4481200/)
- [Google: Architecting Efficient Context-Aware Multi-Agent Framework](https://developers.googleblog.com/architecting-efficient-context-aware-multi-agent-framework-for-production/)

**æ•°æ®æ¥æºè¯´æ˜**: æœ¬æ–‡ä»·æ ¼å’Œæœºåˆ¶æ•°æ®æ¥è‡ªå¤šä¸ª AI çš„ç½‘ç»œè°ƒç ”ç»“æœäº¤å‰éªŒè¯ï¼Œéƒ¨åˆ†æ•°æ®å¯èƒ½éšæ—¶é—´å˜åŒ–ï¼Œè¯·ä»¥å„å®¶å®˜æ–¹æ–‡æ¡£ä¸ºå‡†ã€‚
