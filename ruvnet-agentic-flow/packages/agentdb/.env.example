# AgentDB Authentication Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# JWT CONFIGURATION (REQUIRED)
# =============================================================================
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('base64'))"
JWT_SECRET=REPLACE_WITH_LONG_RANDOM_STRING_AT_LEAST_64_CHARS
REFRESH_TOKEN_SECRET=REPLACE_WITH_DIFFERENT_LONG_RANDOM_STRING

# =============================================================================
# ENVIRONMENT
# =============================================================================
NODE_ENV=production  # production | development | test

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# CORS Origins (comma-separated list)
CORS_ORIGINS=https://yourdomain.com,https://app.yourdomain.com

# Enable HSTS (HTTP Strict Transport Security)
ENABLE_HSTS=true

# Enable CSP (Content Security Policy)
ENABLE_CSP=true

# Development bypass (DANGEROUS - only for development)
ALLOW_DEV_AUTH_BYPASS=false

# =============================================================================
# RATE LIMITING
# =============================================================================
# General API requests per 15 minutes
RATE_LIMIT_GENERAL_MAX=100
RATE_LIMIT_GENERAL_WINDOW_MS=900000

# Authentication attempts per 15 minutes
RATE_LIMIT_AUTH_MAX=5
RATE_LIMIT_AUTH_WINDOW_MS=900000

# Registration attempts per hour
RATE_LIMIT_REGISTRATION_MAX=3
RATE_LIMIT_REGISTRATION_WINDOW_MS=3600000

# =============================================================================
# SESSION CONFIGURATION
# =============================================================================
# Session timeout in milliseconds (default: 30 minutes)
SESSION_TIMEOUT_MS=1800000

# Maximum login attempts before lockout
MAX_LOGIN_ATTEMPTS=5

# Account lockout duration in milliseconds (default: 15 minutes)
LOCKOUT_DURATION_MS=900000

# =============================================================================
# API KEY CONFIGURATION
# =============================================================================
# Default API key expiry in days (default: 365)
API_KEY_DEFAULT_EXPIRY_DAYS=365

# =============================================================================
# AUDIT LOGGING
# =============================================================================
# Enable audit logging
AUDIT_LOGGING_ENABLED=true

# Audit log directory
AUDIT_LOG_DIRECTORY=./logs/audit

# Maximum audit log file size in bytes (default: 10MB)
AUDIT_LOG_MAX_FILE_SIZE=10485760

# Maximum number of audit log files to keep
AUDIT_LOG_MAX_FILES=10

# Log to console in addition to file
AUDIT_LOG_TO_CONSOLE=false

# =============================================================================
# DATABASE (if using persistent storage)
# =============================================================================
# For production, use a real database instead of in-memory storage
# DATABASE_URL=postgresql://user:password@localhost:5432/agentdb
# REDIS_URL=redis://localhost:6379

# =============================================================================
# SECURITY BEST PRACTICES
# =============================================================================
# 1. Never commit this file with real secrets to git
# 2. Use strong, unique secrets for JWT_SECRET and REFRESH_TOKEN_SECRET
# 3. Rotate secrets regularly (every 90 days)
# 4. Use different secrets for development, staging, and production
# 5. Store secrets in a secure vault (AWS Secrets Manager, HashiCorp Vault, etc.)
# 6. Enable HTTPS in production (use Let's Encrypt for free SSL certificates)
# 7. Monitor audit logs for suspicious activity
# 8. Set up alerting for failed authentication attempts
# 9. Implement IP whitelisting for admin endpoints
# 10. Regularly update dependencies (npm audit fix)

# =============================================================================
# QUICK SETUP GUIDE
# =============================================================================
# 1. Copy this file:
#    cp .env.example .env
#
# 2. Generate JWT secrets:
#    node -e "console.log('JWT_SECRET=' + require('crypto').randomBytes(64).toString('base64'))"
#    node -e "console.log('REFRESH_TOKEN_SECRET=' + require('crypto').randomBytes(64).toString('base64'))"
#
# 3. Update the secrets in .env file
#
# 4. Set NODE_ENV to 'production' for production deployments
#
# 5. Configure CORS_ORIGINS with your actual domain(s)
#
# 6. Review and adjust rate limits based on your needs
#
# 7. Set up HTTPS (required for production)
#
# 8. Configure audit logging directory (ensure it's writable)
#
# 9. Test authentication flow in development mode first
#
# 10. Monitor logs and metrics in production
