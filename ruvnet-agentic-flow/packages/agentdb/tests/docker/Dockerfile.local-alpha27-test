FROM node:20-slim

# Install basic tools
RUN apt-get update && apt-get install -y \
    curl \
    && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /test-agentdb

# Copy the built package
COPY dist /agentdb/dist
COPY package.json /agentdb/package.json
COPY schemas /agentdb/schemas

# Copy test script
COPY tests/docker/test-local-alpha27.sh .

# Make script executable
RUN chmod +x test-local-alpha27.sh

# Run test
CMD ["bash", "test-local-alpha27.sh"]
